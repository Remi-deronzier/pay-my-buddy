<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout-general}">
      
	<head>
		<title>Transaction</title>
	</head>
	
	<body>
		<div layout:fragment="content" class="container">
			<h1>Transaction</h1>
			<div class="d-flex justify-content-between mb-2">
				<h3>Send money</h3>
				<a th:href="@{/users/contact/add}" class="btn btn-outline-primary" role="button">Add connection</a>
			</div>
			<div class="card bg-light">
				<div class="card-body">
					<form class="row row-cols-md-auto g-2 align-items-end justify-content-center"
					th:if="${!connections.isEmpty}" action="#" th:action="@{/transactions/makeTransaction}"
					th:object="${receiver}" method="post">
						<div class="col-12">
							<label for="selectConnection" class="form-label">Select a connection</label>
							<select class="form-select" aria-label="Default select" id="selectConnection" th:field="*{id}">
				    			<option th:each="user: ${connections}" th:value="${user.id}" th:text="${user.userName} + ' - ' + ${user.firstName} + ' ' + ${user.lastName}"></option>
							</select>
						</div>
						<div class="col-12" th:object="${newTransaction}">
							<label for="amount" class="form-label">Enter the amount</label>
							<div class="input-group">
								<div class="input-group-text">€</div>
								<input type="number" step="any" class="form-control" placeholder="Amount" id="amount" th:field="*{amount}">
							</div>
						</div>
						<div class="col-12" th:object="${newTransaction}">
							<label for="description" class="form-label">Enter the description</label>
							<input type="text" class="form-control" placeholder="Description" id="description" th:field="*{description}">
						</div>
						<div class="col-12">
							<button type="submit" class="btn btn-primary">Pay</button>
						</div>
					</form>
				</div>
			</div>
			
			
			<h3 class="mt-4">My transactions</h3>
			<table th:if="${!page.getContent().isEmpty}" class="table table-striped table-bordered">
				<thead>
					<tr class="table-primary">
						<th>Connection</th>
						<th>Description</th>
						<th>Date</th>
						<th>Amount</th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="transaction : ${page.getContent()}">
						<td>
							<strong th:if="${transaction.getSender().getId() == 1}" th:text="'Sent to: '"></strong>
							<strong th:unless="${transaction.getSender().getId() == 1}" th:text="'Received from: '"></strong>
							<span th:if="${transaction.getSender().getId() == 1}" th:text="${transaction.getReceiver().getUserName()}"></span>
							<span th:unless="${transaction.getSender().getId() == 1}" th:text="${transaction.getSender().getUserName()}"></span>
						</td>
						<td th:text="${transaction.description}"></td>
						<td th:text="${transaction.timeStamp}"></td>
						<td>
							<span th:if="${transaction.getSender().getId() == 1}" th:text="'-' + ${transaction.amount} + ' €'"></span>
							<span th:unless="${transaction.getSender().getId() == 1}" th:text="${transaction.amount} + ' €'"></span>
						</td>
					</tr>
				</tbody>
			</table>
			
			<p th:unless="${!page.getContent().isEmpty}">No transaction to display</p>
		</div>

	</body>
	
</html>